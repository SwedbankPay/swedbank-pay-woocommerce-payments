{"version":3,"sources":["order-status.js"],"names":["jQuery","$","window","wc_sb_order_status","xhr","attempts","init","this","checkPayment","err","data","status_elm","success_elm","failed_elm","state","hide","show","append","message","setTimeout","callback","ajax","type","url","WC_Gateway_Swedbank_Pay_Order_Status","ajax_url","action","nonce","order_id","order_key","dataType","always","block","check_message","overlayCSS","background","opacity","done","response","unblock","document","ready"],"mappings":"AAAAA,OAAQ,SAAUC,GACd,aAEAC,OAAOC,mBAAqB,CACxBC,KAAK,EACLC,SAAU,EAKVC,KAAM,WACFC,KAAKC,aAAc,SAAWC,EAAKC,GAC/B,IAAIC,EAAaV,EAAG,0BAChBW,EAAcX,EAAG,kBACjBY,EAAaZ,EAAG,iBAEpB,OAASS,EAAKI,OACV,IAAK,OACDH,EAAWI,OACXH,EAAYI,OACZ,MACJ,IAAK,SACL,IAAK,UACDL,EAAWI,OACXF,EAAWI,OAAO,MAAQP,EAAKQ,QAAU,QACzCL,EAAWG,OACX,MACJ,QAGI,GAFAd,OAAOC,mBAAmBE,WAErBH,OAAOC,mBAAmBE,SAAW,EACtC,OAGJc,WAAW,WACPjB,OAAOC,mBAAmBG,QAC3B,SASnBE,aAAc,SAAWY,GACrB,OAAOnB,EAAEoB,KAAM,CACXC,KAAM,OACNC,IAAKC,qCAAqCC,SAC1Cf,KAAM,CACFgB,OAAQ,6BACRC,MAAOH,qCAAqCG,MAC5CC,SAAUJ,qCAAqCI,SAC/CC,UAAWL,qCAAqCK,WAEpDC,SAAU,SACVC,OAAQ,WACR9B,EAAG,sBAAuB+B,MAAO,CAC7Bd,QAASM,qCAAqCS,cAC9CC,WAAY,CACRC,WAAY,OACZC,QAAS,QAGjBC,KAAM,SAAWC,GACjBrC,EAAG,gBAAiBsC,UACpBnB,EAAU,KAAMkB,EAAS5B,UAKrCT,EAAEuC,UAAUC,MAAO,WACfvC,OAAOC,mBAAmBG","file":"order-status.min.js","sourcesContent":["jQuery( function( $ ) {\n    'use strict';\n\n    window.wc_sb_order_status = {\n        xhr: false,\n        attempts: 0,\n\n        /**\n         * Initialize the checking\n         */\n        init: function() {\n            this.checkPayment( function ( err, data ) {\n                var status_elm = $( '#order-status-checking' ),\n                    success_elm = $( '#order-success' ),\n                    failed_elm = $( '#order-failed' );\n\n                switch ( data.state ) {\n                    case 'paid':\n                        status_elm.hide();\n                        success_elm.show();\n                        break;\n                    case 'failed':\n                    case 'aborted':\n                        status_elm.hide();\n                        failed_elm.append(\"<p>\" + data.message + \"</p>\");\n                        failed_elm.show();\n                        break;\n                    default:\n                        window.wc_sb_order_status.attempts++;\n\n                        if ( window.wc_sb_order_status.attempts > 6) {\n                            return;\n                        }\n\n                        setTimeout(function () {\n                            window.wc_sb_order_status.init();\n                        }, 10000);\n                }\n            } );\n        },\n\n        /**\n         * Check payment\n         * @return {JQueryPromise<any>}\n         */\n        checkPayment: function ( callback ) {\n            return $.ajax( {\n                type: 'POST',\n                url: WC_Gateway_Swedbank_Pay_Order_Status.ajax_url,\n                data: {\n                    action: 'swedbank_pay_check_payment',\n                    nonce: WC_Gateway_Swedbank_Pay_Order_Status.nonce,\n                    order_id: WC_Gateway_Swedbank_Pay_Order_Status.order_id,\n                    order_key: WC_Gateway_Swedbank_Pay_Order_Status.order_key,\n                },\n                dataType: 'json'\n            } ).always( function() {\n                $( '.woocommerce-order' ).block( {\n                    message: WC_Gateway_Swedbank_Pay_Order_Status.check_message,\n                    overlayCSS: {\n                        background: '#fff',\n                        opacity: 0.6\n                    }\n                } );\n            } ).done( function ( response ) {\n                $( '.woocommerce' ).unblock();\n                callback( null, response.data );\n            } );\n        },\n    };\n\n    $(document).ready( function () {\n        window.wc_sb_order_status.init();\n    } );\n} );\n"]}