jQuery((function(e){"use strict";window.wc_sb_seamless={xhr:!1,init:function(t){this.form=t,this.form_submit=!1,this.js_url=null,e(this.form).on("click","#place_order",{obj:this},this.onSubmit),e(this.form).on("submit checkout_place_order_"+this.gateway_id),this.addAjaxHook(),this.checkPaymentUrl()},onSubmit:function(e){return!!e.data.obj.form_submit||!!e.data.obj.validateForm()&&(console.log("onSubmit"),!e.data.obj.form.is(".processing")&&(console.log(this.js_url),void e.data.obj.waitForJsUrl()))},validateForm:function(){var t,o=!0;return(t=e("#ship-to-different-address-checkbox").is(":checked")?e(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required").find("input, select").not(e("#account_password, #account_username")):e(".woocommerce-billing-fields .validate-required").find("input, select").not(e("#account_password, #account_username"))).length&&t.each((function(){var t=e(this),n=t.closest(".form-row"),s=n.is(".validate-required"),i=n.is(".validate-email");(s&&("checkbox"!==t.attr("type")||t.is(":checked")?""===t.val()&&(o=!1):o=!1),i)&&(t.val()&&(new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(t.val())||(o=!1)))})),o},setJsUrl:function(e){console.log("setJsUrl"),console.log(e),this.js_url=e},waitForJsUrl:function(){var e=this;let t=window.setInterval((function(){e.js_url&&(console.log("waitForJsUrl: "+e.js_url),window.clearInterval(t),e.initFrame(e.js_url,(function(){e.js_url=null})))}),1e3)},initFrame:function(t,o){void 0===o&&(o=function(){}),e("script[src*='px.creditcard.client.js']").remove(),e("script[src*='px.invoice.client.js']").remove(),e("script[src*='px.mobilepay.client.js']").remove(),e("script[src*='px.swish.client.js']").remove(),e("script[src*='px.trustly.client.js']").remove(),e("script[src*='px.vipps.client.js']").remove();var n=this;this.loadJs(t,(function(){e(".swedbank-pay-seamless iframe").remove(),e.featherlight('<div class="swedbank-pay-seamless" id="swedbank-pay-seamless'+n.gateway_id+'">&nbsp;</div>',{variant:"featherlight-swedbank-seamless",persist:!1,closeOnClick:!1,closeOnEsc:!1,afterOpen:function(){console.log(n),n.initPaymentMenu("swedbank-pay-seamless"+n.gateway_id)},afterClose:function(){e(".swedbank-pay-seamless iframe").remove(),n.form.removeClass("processing").unblock()}}),o()}))},loadJs:function(e,t){let o=document.createElement("script");o.setAttribute("src",e),o.setAttribute("type","text/javascript"),o.setAttribute("async",""),o.addEventListener("load",(function(){t()}),!1);let n=document.getElementsByTagName("head")[0];return n&&n.appendChild(o),o},initPaymentMenu:function(e,t){console.log("initPaymentMenu"),void 0===t&&(t=function(){}),this.paymentMenu=window.payex.hostedView[this.hostedView]({container:e,culture:this.culture,onApplicationConfigured:function(e){console.log("onApplicationConfigured"),console.log(e),t(null)},onPaymentCreated:function(e){console.log("onPaymentCreated"),console.log(e.id)},onPaymentCompleted:function(e){console.log("onPaymentCompleted"),console.log(e),self.location.href=e.redirectUrl},onPaymentCanceled:function(e){console.log("onPaymentCanceled"),console.log(e)},onPaymentFailed:function(e){console.log("onPaymentFailed"),console.log(e),self.location.href=e.redirectUrl},onError:function(e){console.log(e),t(e)}}),this.paymentMenu.open()},addAjaxHook:function(){var t=this;e(document).ajaxComplete((function(e,o,n){if(n.url===wc_checkout_params.checkout_url||n.url.indexOf("wc-ajax=complete_order")>-1){const e=o.responseText;try{const o=JSON.parse(e);if(!o.hasOwnProperty(t.key))return!1;t.setJsUrl(o.js_url)}catch(e){return!1}}}))},checkPaymentUrl:function(){new URLSearchParams(document.location.search).get("payment_url")&&this.initFrame(this.payment_url,(function(){console.log("Payment url has been loaded.")}))}}}));
//# sourceMappingURL=seamless.min.js.map
